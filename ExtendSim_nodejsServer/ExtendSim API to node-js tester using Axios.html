<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>ExtendSim ASP API tester</title>
  <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      padding: 5px;
      text-align: left;    
    }
    .login {
        margin-right: 20px;
    }
    .input-file-row {
        width: 350px;
    }
    .database-input-row {
        width: 350px;
    }
    .upload-files-button {
        margin-top: 10px;
        margin-right: 10px;
    }
    .upload-database-inputs-button {
        margin-top: 10px;
        margin-right: 10px;
    }
    .upload-dialog-inputs-button {
        margin-top: 10px;
        margin-right: 10px;
    }
    #extendsim-asp-axios-tester-frame {
        width: 90%;
        padding: 10px;
        border-color: blue,;
        border-width: 2px;
        border-style: solid;
        border-radius: 10px;
        background-color: #c9d6ff;
        font-size: 14px;
        font-family: Arial, Helvetica, sans-serif;
        font-weight: bold;
    }
    #input-files-table, #database-inputs-table, #dialog-inputs-table {
        background-color: #ecedf0;
    }
    #user-form {
        width: auto;
        padding: 20px;
        margin-bottom: 20px;
        /* margin-right: 10px; */
        border-color: black;
        border-width: 2px;
        border-style: solid;
        border-radius: 10px;
        background-color: #c9ffd6;
    }
    #scenario-name {
        width: 30%;
    }

    #user-login-session-id {
        width: 300px;
    }
    #user-login-session-id-label {
        margin-left: 20px;
    }
    #user-scenario-folder-pathname {
        width: 600px;
    }
    #user-scenario-folder-pathname-label {
        margin-left: 20px;
    }
    #user-models-label {
        margin-left: 20px;
    }
    #model-copied-status-label {
        margin-left: 20px;
    }
    #upload-filename-label {
        margin-left: 20px;
    }
    #user-scenario-folder-pathname {
        margin-right: 20px;
    }
    #scenario-factors {
        border: 2px solid rgb(0, 0, 0);
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        /* margin-right: 10px; */
        width: auto;
        background-color:rgb(221, 220, 220);
        overflow: auto;
    }
    #scenario-id-label {
        margin-left: 20px;
    }
    #scenario-id {
        margin-right: 20px;
    }
    #scenario-status-label {
        margin-left: 20px;
    }
    #show-input-files-label, #show-database-inputs-label, #show-dialog-inputs-label {
        font-size: 16px;
        font-family: Arial, Helvetica, sans-serif;
        font-weight: bold;
        margin-bottom: 20px;
    }
    #show-input-files, #show-database-inputs, #show-dialog-inputs {
        margin-bottom: 20px;
        margin-right: 20px;
    }
    #scenario-input-files {
        border: 2px solid blue;
        border-radius: 10px;
        padding-left: 20px;
        padding-right: 20px;
        padding-bottom: 20px;
        margin-bottom: 20px;
        margin-right: 10px;
        width: auto;
        background-color:rgb(253, 246, 204);
        float: left;
    }
    #scenario-database-inputs {
        border: 2px solid blue;
        border-radius: 10px;
        padding-left: 20px;
        padding-right: 20px;
        padding-bottom: 20px;
        margin-bottom: 20px;
        margin-right: 10px;
        background-color:rgb(253, 246, 204);
        width: auto;
        float: left;
    }
    #scenario-dialog-inputs {
        border: 2px solid blue;
        border-radius: 10px;
        padding-left: 20px;
        padding-right: 20px;
        padding-bottom: 20px;
        margin-bottom: 20px;
        background-color: rgb(253, 246, 204);
        width: auto;
        float: left;
    }
    #submit-simulation {
        border: 2px solid blue;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        background-color: rgb(248, 179, 179);
        width: auto;
        clear: left;
    }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>        
    <div id="extendsim-asp-axios-tester-frame">
        <div id="user-form">
            Username: <input class="login" id="username" type="text" name="username" value=""></input>
            Password: <input class="login" id="password" type="password" name="password" value=""></input>
            <br></br>
            <button class="buttons" id="users/login">Login to server</button>
            <label id="user-login-session-id-label">User Login Session ID:</label>
            <input id="user-login-session-id"></input>    
            <br></br> 
            <button class="buttons" id="ExtendSim/getUserModelPaths">Get user model paths</button>
            <select id="user-models"></select>
            <br></br>   
            <label id="scenario-name-label">Scenario name:</label>
            <input id="scenario-name"></input>
            <br></br>
            <button class="buttons" id="ExtendSim/createScenarioFolder">Create scenario folder</button>
            <label id="user-scenario-folder-pathname-label">Scenario folder pathname:</label>
            <input id="user-scenario-folder-pathname"></input>
            <br></br>
            <button class="buttons" id="ExtendSim/copyModelToScenarioFolder">Copy model to scenario folder</button>
            <label id="model-copied-status-label">Model copied:</label>
            <input id="model-copied-status" type="checkbox"></input>    
        </div>
        <div id="scenario-factors">
            <div>
                <label id="show-input-files-label">Show scenario input files table</label>
                <input id="show-input-files" type="checkbox" onclick='updateInputFilesTableVisibility()'></input>    
                <label id="show-database-inputs-label">Show scenario database inputs table</label>
                <input id="show-database-inputs" type="checkbox" onclick='updateDatabaseInputsTableVisibility()'></input>    
                <label id="show-dialog-inputs-label">Show scenario dialog inputs table</label>
                <input id="show-dialog-inputs" type="checkbox" onclick='updateDialogInputsTableVisibility()'></input>    
            </div>
            <div id="scenario-input-files">
                <h3>Scenario Input Files</h3>
                <button class="scenario-input-file-buttons" onclick='addInputFilesTableRow()'>Add row</button>
                <button class="scenario-input-file-buttons" onclick='deleteInputFilesTableRow()''>Delete row</button>
                <table id="input-files-table" style="width:auto">
                    <tr>
                        <th>
                            Source data file
                        </th>
                    </tr>
                </table>
                <button class="upload-files-button" id="ExtendSim/sendfile">Upload scenario input files to server</button>
                <label id="files-uploaded-status-label">Files uploaded:</label>
                <input id="files-uploaded-status" type="checkbox"></input>
            </div>
            <div id="scenario-database-inputs">
                <h3>Scenario Database Inputs</h3>
                <button class="scenario-database-input-buttons" id="add-database-inputs-table-row" onclick='addNewDatabaseInputsTableRow()'>Add row</button>
                <button class="scenario-database-input-buttons" id="delete-database-inputs-table-row" onclick='deleteDatabaseInputsTableRow()'>Delete row</button>
                <table id="database-inputs-table" style="width:auto">
                    <tr>
                        <th>
                            Source data file
                        </th>
                        <th>
                            Target Database
                        </th>
                        <th>
                            Target Table
                        </th>
                    </tr>
                </table>
                <button class="upload-database-inputs-button" id="ExtendSim/sendfile">Upload inputs to database tables</button>
                <label id="database-inputs-uploaded-status-label">Files uploaded:</label>
                <input id="database-inputs-uploaded-status" type="checkbox"></input>
            </div>
            <div id="scenario-dialog-inputs">
                <h3>Scenario Dialog Inputs</h3>
                <button class="scenario-dialog-input-buttons" id="add-dialog-inputs-table-row" onclick='addNewDialogInputsTableRow()'>Add row</button>
                <button class="scenario-dialog-input-buttons" id="delete-dialog-inputs-table-row" onclick='deleteDialogInputsTableRow()'>Delete row</button>
                <table id="dialog-inputs-table" style="width:auto">
                    <tr>
                        <th>
                            Block Type
                        </th>
                        <th>
                            Block Number
                        </th>
                        <th>
                            Variable Type
                        </th>
                        <th>
                            Dialog Variable
                        </th>
                        <th>
                            Input Value
                        </th>
                    </tr>
                </table>
                <button class="upload-dialog-inputs-button" id="ExtendSim/sendfile">Upload inputs to dialog variables</button>
                <label id="dialog-inputs-uploaded-status-label">Inputs uploaded:</label>
                <input id="dialog-inputs-uploaded-status" type="checkbox"></input>
            </div>
        </div>
        <div id="submit-simulation">
            <button class="buttons" id="ExtendSim/submitsimulationscenario">Submit scenario</button>
            <label id="scenario-id-label">Scenario ID:</label>
            <input id="scenario-id"></input>
            <button class="buttons" id="ExtendSim/checkmodelrunstatus">Check scenario status</button>
            <label id="scenario-status-label">Scenario status:</label>
            <input id="scenario-status"></input>
        </div>
    </div>
    <script type="text/javascript">
    var modelBlocks = [];
    var blockNumbers = [];
    var dialogItemTypes = [];
    var uploadedFiles = [];
    var uploadedDatabaseFiles = [];
    var selectedFiles = [];
    var selectedDatabaseFiles = [];
    var modelDatabases = [];
    var modelBlockInfo;
    var inputFileTableRows = 0;
    var databaseInputsTableRows = 0;
    var dialogInputsTableRows = 0;
    const scenarioStatusValues = ['Waiting to run', 'Running', 'Completed', 'Aborted']
    var numFilesUploaded = 0;

    const IPaddress = "http://184.171.246.58";
    // const IPaddress = "localhost";
    // var queryURL_root = "http://" + IPaddress + ":8090/StreamingService/web/"
    var queryURL_root =  IPaddress + ":3001/api/"
    var queryURL_root2 = "http://" + IPaddress + ":3001/api/users/login/"
    var queryURL = "http://" + IPaddress + ":8090/StreamingService/web/LoginToServer"
    var queryURL2 = "http://" + IPaddress + ":8090/StreamingService/web/EchoWithGet"
    var queryURL3 = "http://" + IPaddress + ":8090/StreamingService/web/GetServerDirectoryFiles"
    // var queryURL = "http://" + IPaddress + ":8090/StreamingService/web/LoginToServer?username=analyst1&password=model"
    // const proxyurl = "https://cors-anywhere.herokuapp.com/";
    const proxyurl = "";
    const pathname = "C:\Users\Administrator\Documents\ExtendSim10ASP_Prod\ASP\ASP Servers\ExtendSim Models\Analyst 1";

    // const username = 'analyst1';
    // const password = 'model';

    $('.buttons').prop('disabled', true);
    $('#show-input-files').prop('checked', true);
    $('#show-database-inputs').prop('checked', true);
    $('#show-dialog-inputs').prop('checked', true);
    $('.scenario-input-file-buttons').prop('disabled', true);
    $('.scenario-database-input-buttons').prop('disabled', true);
    $('.scenario-dialog-input-buttons').prop('disabled', true);
    $('.upload-dialog-inputs-button').prop('disabled', true);
    $('.upload-database-inputs-button').prop('disabled', true);
    $('.upload-files-button').prop('disabled', true);
    $("#model-copied-status").prop('checked', false);

    function databasefilesSelected(event) {
        var files = $("#" + event.target.id)[0].files;
        if (files) {
            [].forEach.call(files, readAndPreviewDatabaseInputFile);
        }
        enableDisableUploadFilesToDatabaseTablesButton();    
    }
    function inputFilesSelected(event) {
        var files = $("#" + event.target.id)[0].files;
        if (files) {
            [].forEach.call(files, readAndPreviewInputFile);
        }
        enableDisableUploadFilesButton();
    }
    function readAndPreviewInputFile(file) {
        var reader  = new FileReader();
        reader.onload = function(event) {
            var contents = event.target.result;
            uploadedFiles[numFilesUploaded].data = contents;
           numFilesUploaded++;
        };

        if (file) {
            uploadedFiles.push({ name: file.name });
            selectedFiles.push(file);
            reader.readAsText(file);
        }
    }
    function readAndPreviewDatabaseInputFile(file) {
        var reader  = new FileReader();
        reader.onload = function(event) {
            var contents = event.target.result;
            uploadedDatabaseFiles[numFilesUploaded].data = contents;
           numFilesUploaded++;
        };

        if (file) {
            uploadedFiles.push({ name: file.name });
            selectedDatabaseFiles.push(file);
            reader.readAsText(file);
        }
    }
    function enableDisableUploadFilesButton() {
        if (selectedFiles.length === 0)  {
            $('.upload-files-button').prop('disabled', true);
        }
        else {
            $('.upload-files-button').prop('disabled', false);
        }
    }
    function enableDisableUploadFilesToDatabaseTablesButton() {
        if (selectedDatabaseFiles.length === 0)  {
            $('.upload-database-inputs-button').prop('disabled', true);
        }
        else {
            $('.upload-database-inputs-button').prop('disabled', false);
        }
    }
    function enableDisableCopyModelToScenarioFolderButton() {
        const scenarioFolderPathname = $("#user-scenario-folder-pathname").val();
        const userModelPathname = $("#user-models").val();
    }
    function updateInputFilesTableVisibility() {
        if ($('#show-input-files'). prop("checked") == true) {
            $("#scenario-input-files").show();
        } else {
            $("#scenario-input-files").hide();
        }
    }
    function updateDatabaseInputsTableVisibility() {
        if ($('#show-database-inputs'). prop("checked") == true) {
            $("#scenario-database-inputs").show();
        } else {
            $("#scenario-database-inputs").hide();
        }
    }
    function updateDialogInputsTableVisibility() {
        if ($('#show-dialog-inputs'). prop("checked") == true) {
            $("#scenario-dialog-inputs").show();
        } else {
            $("#scenario-dialog-inputs").hide();
        }
    }
    function addInputFilesTableRow() {
        var table = $("#input-files-table");
        inputFileTableRows++;
        var newrow = '<tr><td><input type="file" onchange="inputFilesSelected(event)" class="input-file-row" id="input-button-' + inputFileTableRows + '"></td></tr>';
        table.append(newrow);
    }
    function deleteInputFilesTableRow(event) {
        if (inputFileTableRows > 0) {
            inputFileTableRows--;
        }
        $("#input-files-table tr:last").remove();
    }

    function addNewDatabaseInputsTableRow() {
        var table = $("#database-inputs-table");
        databaseInputsTableRows++;
        var newrow = 
        '<tr><td><input type="file" id="database-input-button-' + databaseInputsTableRows + '" onchange="databasefilesSelected(event)" class="input-file-row"></td><td><select id="target-database-' + databaseInputsTableRows + '"></select></td><td><select id="target-table-' + databaseInputsTableRows + '"></select></td></tr>'
        table.append(newrow);
        var targetDatabase = '#target-database-' + databaseInputsTableRows;
        for (var i = 0; i < modelDatabases.length; i++) {
            $(targetDatabase).append('<option value="' + modelDatabases[i].name + '">' + modelDatabases[i].name + '</option>');
        }
        if (modelDatabases.length > 0) {
            $(targetDatabase).val(modelDatabases[0].name);
        }
        var targetTable = '#target-table-' + databaseInputsTableRows;
        for (var i = 0; i < modelDatabases[0].tableNames.length; i++) {
            $(targetTable).append('<option value="' + modelDatabases[0].tableNames[i] + '">' + modelDatabases[0].tableNames[i] + '</option>');
        }
        if (modelDatabases[0].tableNames.length > 0) {
            $(targetTable).val(modelDatabases[0].tableNames[0]);
        }
    }

    function deleteDatabaseInputsTableRow(event) {
        if (databaseInputsTableRows > 0) {
            databaseInputsTableRows--;
        }
        $("#database-inputs-table tr:last").remove();  
    }

    function addNewDialogInputsTableRow() {
        var table = $("#dialog-inputs-table");
        dialogInputsTableRows++;
        var newrow = 
        '<tr><td><select id="block-type-select-' + dialogInputsTableRows + '" onchange="blockTypeSelected(event)"></select></td><td><select id="block-number-select-' + dialogInputsTableRows + '" onchange="blockNumberSelected(event)"></select></td><td><select id="dialog-item-type-select-' + dialogInputsTableRows + '" onchange="dialogItemTypeSelected(event)"></select></td><td><select id="dialog-variable-select-' + dialogInputsTableRows + '" onchange="dialogVariableSelected(event)"></select></td><td><input type="text" id="dialog-input-' + dialogInputsTableRows + '"></input></td></tr>'     
        table.append(newrow);
        var blockType = '#block-type-select-' + dialogInputsTableRows;
        for (var i = 0; i < modelBlocks.length; i++) {
            $(blockType).append('<option value="' + modelBlocks[i] + '">' + modelBlocks[i] + '</option>');
        }
        if (modelBlocks.length > 0) {
            $(blockType).val(modelBlocks[0]);
            var blockNumber = '#block-number-select-' + dialogInputsTableRows;
            updateBlockNumbersDropdown(dialogInputsTableRows);
            updateDialogItemTypeDropdown(dialogInputsTableRows);
        }
    }

    function deleteDialogInputsTableRow(event) {
        if (dialogInputsTableRows > 0) {
            dialogInputsTableRows--;
        }
        $("#dialog-inputs-table tr:last").remove();  
    }

    function updateBlockNumbersDropdown(rowIndex) {
        var blockType = '#block-type-select-' + rowIndex;
        var blockNumber = '#block-number-select-' + rowIndex;

        blockNumbers = [];
        var tempArray = [];
        for (var i=0;i<modelBlockInfo.length;i++) {
            if ($(blockType).val() === modelBlockInfo[i].blockName) {
                tempArray.push(modelBlockInfo[i].blockNumber);
            }
        }
        blockNumbers = Array.from(new Set(tempArray));
        blockNumbers.sort();
        $(blockNumber).empty();
        for (var i = 0; i < blockNumbers.length; i++) {
            $(blockNumber).append('<option value="' + blockNumbers[i] + '">' + blockNumbers[i] + '</option>');
        }
        updateDialogItemTypeDropdown(rowIndex);
    }

    function updateDialogItemTypeDropdown(rowIndex) {
        var blockNumber = '#block-number-select-' + rowIndex;
        var dialogItemType = '#dialog-item-type-select-' + rowIndex;
        dialogItemTypes = [];
        var tempArray = [];
        for (var i=0;i<modelBlockInfo.length;i++) {
            if ($(blockNumber).val() === modelBlockInfo[i].blockNumber) {
                tempArray.push(modelBlockInfo[i].dialogItemType);
            }
        }
        dialogItemTypes = Array.from(new Set(tempArray));
        dialogItemTypes.sort();
        $(dialogItemType).empty();
        for (var i = 0; i < dialogItemTypes.length; i++) {
            $(dialogItemType).append('<option value="' + dialogItemTypes[i] + '">' + dialogItemTypes[i] + '</option>');
        }
        updateDialogVariableDropdown(rowIndex);
    }

    function updateDialogVariableDropdown(rowIndex) {
        var blockNumber = '#block-number-select-' + rowIndex;
        var dialogItemType = '#dialog-item-type-select-' + rowIndex;
        var dialogVariable = '#dialog-variable-select-' + rowIndex;
        dialogVariables = [];
        var tempArray = [];
        for (var i=0;i<modelBlockInfo.length;i++) {
            if (($(blockNumber).val() === modelBlockInfo[i].blockNumber) &&
                ($(dialogItemType).val() === modelBlockInfo[i].dialogItemType)) {
                tempArray.push(modelBlockInfo[i].variableName);
            }
        }
        dialogVariables = Array.from(new Set(tempArray));
        dialogVariables.sort();
        $(dialogVariable).empty();
        for (var i = 0; i < dialogVariables.length; i++) {
            $(dialogVariable).append('<option value="' + dialogVariables[i] + '">' + dialogVariables[i] + '</option>');
        }      
    }

    function blockTypeSelected(event) {
        var index = event.target.id.lastIndexOf('-') + 1;
        var rowIndex = event.target.id.substring(index);
        updateBlockNumbersDropdown(rowIndex);
    }
    function blockNumberSelected(event) {
        var index = event.target.id.lastIndexOf('-') + 1;
        var rowIndex = event.target.id.substring(index);
        updateDialogItemTypeDropdown(rowIndex);
    }

    function dialogItemTypeSelected(event) {
        var index = event.target.id.lastIndexOf('-') + 1;
        var rowIndex = event.target.id.substring(index);
        updateDialogVariableDropdown(rowIndex);  
    }

    function CopyTextFilesToServer(fileIndex) {
        var reader = new FileReader();

        reader.onload = function(event) {
        event.preventDefault();
        // alert("Copying file=" + uploadedFiles[fileIndex].name);
            axios({
                url: proxyurl + queryURL_root + "ExtendSim/sendfile",
                method: 'post',
                accept : 'application/json',
                contentType: 'application/json;charset=utf-8',
                data : {
                    scenarioFolderPathname: $("#user-scenario-folder-pathname").val(),
                    filename: selectedFiles[fileIndex].name,
                    filedata: reader.result
                }
            })
            .then(function(response) {
                fileIndex++;
                if (fileIndex < selectedFiles.length) {
                    CopyTextFilesToServer(fileIndex);
                } else {
                    $("#files-uploaded-status").prop('checked', true);
                }
            });
        }
        // alert('Reading uploaded file...');
        reader.readAsText(selectedFiles[fileIndex]);
    }
    
    function getmodeldatabases() {
        axios({
            url: proxyurl + queryURL_root + "ExtendSim/getmodeldatabases",
            method: 'post',
            accept : 'application/json',
            contentType: 'application/json;charset=utf-8',
            data : {
                modelPathname: $("#user-models").val(),
                closeModel: true
            }
        })
        .then(function(response) {
            modelDatabases= [];
            for (var i=0;i<response.data.modelDatabases.length;i++) {
                if (response.data.modelDatabases[i].charAt(0) !== "_") {
                    modelDatabases.push({ name: response.data.modelDatabases[i],
                                          tableNames: [] });
                    if (modelDatabases.length === 1) {
                        getDatabaseTables(modelDatabases.length - 1, getModelInfo);
                        // getDatabaseTables(modelDatabases.length - 1, '');
                    } else {
                        getDatabaseTables(modelDatabases.length - 1, '');
                    }
                }
            };
        });
    }

    function getDatabaseTables(databaseIndex, callback) {
        axios({
            url: proxyurl + queryURL_root + "ExtendSim/getmodeldatabasetables",
            method: 'post',
            accept : 'application/json',
            contentType: 'application/json;charset=utf-8',
            data : {
                modelPathname: $("#user-models").val(),
                database: modelDatabases[databaseIndex].name,
                closeModel: true
            }
        })
        .then(function(response) {
            modelDatabases[databaseIndex].tableNames = response.data.modelDatabaseTables;
            modelDatabases[databaseIndex].tableNames.sort();
            if (callback !== '') {
                callback();
            }
        });
    }

    function getModelInfo() {
        axios({
            url: proxyurl + queryURL_root + "ExtendSim/getmodelinfo",
            method: 'post',
            accept : 'application/json',
            contentType: 'application/json;charset=utf-8',
            data : {
                modelpathname: $("#user-models").val(),
                closeModel: true
            }
        })
        .then(function(response) {
            modelInfo = response.data.ModelInfo;
            console.log("ModelInfo: " + JSON.stringify(modelInfo));
            getDatabaseTableContentsStream(response.data.ModelInfo);
        });
    }
    function getDatabaseTableContentsStream(modelInfo) {
        axios({
            url: proxyurl + queryURL_root + "ExtendSim/getdatabasetablecontentsstream",
            method: 'post',
            accept : 'application/json',
            contentType: 'application/json;charset=utf-8',
            data : {
                modelpathname: $("#user-models").val(),
                databaseName: modelInfo.Databasename,
                tableName: modelInfo.Tablename
            }
        })
        .then(function(response) {
            modelBlockInfo = [];
            response.data.tableDataArray.forEach(function(elements, index) {
                modelBlockInfo.push(
                {
                    variableName: elements[0],
                    dialogItemType: elements[1],
                    blockName: elements[2],
                    blockNumber: elements[3],
                    tabname: elements[4],
                    blockLabel: elements[5],
                    enclosingHblockNumber: elements[6],
                    enclosingHblockLabel: elements[7],  
                });
            })
            modelBlocks = [];
            var tempArray = [];
            for (var i=0;i<modelBlockInfo.length;i++) {
                tempArray.push(modelBlockInfo[i].blockName);
            }
            modelBlocks = Array.from(new Set(tempArray));
            modelBlocks.sort();
        });       
    }

    enableDisableUploadFilesButton();

    // Event listener for all button elements
    $("button").on("click", function() {
      // In this case, the "this" keyword refers to the button that was clicked
      switch (this.id) {
        case 'users/login':

            axios({
                url: proxyurl + queryURL_root + this.id,
                method: 'post',
                accept : 'application/json',
                contentType: 'application/json;charset=utf-8',
                data : {
                    username:  $("#username").val(),
                    password: $("#password").val()
                }
            })
            .then(function(response) {
                // Storing an array of results in the results variable
                // alert('Axios POST parameters result=' + JSON.stringify(response.data));
                $("#user-login-session-id").val(response.data.userLoginSessionID);
            });
          break;

        case 'ExtendSim/createScenarioFolder':

            axios({
                url: proxyurl + queryURL_root + this.id,
                method: 'post',
                accept : 'application/json',
                contentType: 'application/json;charset=utf-8',
                // params: {
                data: {
                    userLoginSessionID : $("#user-login-session-id").val(),
                    scenarioFolderName : $("#scenario-name").val(),
                }
            })
            .then(function(response) {
                // Storing an array of results in the results variable
                // alert('Axios POST parameters result=' + JSON.stringify(response.data));
                $("#user-scenario-folder-pathname").val(response.data.scenarioFolderPathname);
                this.enableDisableCopyModelToScenarioFolderButton();
            });
            break;

        case 'ExtendSim/getUserModelPaths':

            axios({
                url: proxyurl + queryURL_root + this.id,
                method: 'post',
                accept : 'application/json',
                contentType: 'application/json;charset=utf-8',
                data: {
                    username : $("#username").val(),
                }
            })
            .then(function(response) {
                var userModelPaths = response.data.userModelPaths;
                for (var i = 0; i < userModelPaths.length; i++) {
                    $('#user-models').append('<option value="' + userModelPaths[i] + '">' + userModelPaths[i] + '</option>');
                }
                if (userModelPaths.length > 0) {
                    $('#user-models').val(userModelPaths[0]);
                }
                this.enableDisableCopyModelToScenarioFolderButton();
                getmodeldatabases();
            });
            break;

        case 'ExtendSim/copyModelToScenarioFolder':

            axios({
                url: proxyurl + queryURL_root + this.id,
                method: 'post',
                accept : 'application/json',
                contentType: 'application/json;charset=utf-8',
                data: {
                    modelPathname: $("#user-models").val(),
                    scenarioFolderPathname: $("#user-scenario-folder-pathname").val(),
                    copyFolderContents: true
                }
            })
            .then(function(response) {
                $("#model-copied-status").prop('checked', true);
                $("#model-copied-status").prop('disabled', true);
            });
            break;

        case 'ExtendSim/sendfile':

            CopyTextFilesToServer(0);
            break;

        case 'ExtendSim/submitsimulationscenario':

            var modelName =  $("#user-models").val();
            modelName = modelName.substring(modelName.lastIndexOf("\\") + 1);
            axios({
                url: proxyurl + queryURL_root + this.id,
                method: 'post',
                accept : 'application/json',
                contentType: 'application/json;charset=utf-8',
                data: {
                    userLoginSessionID: $("#user-login-session-id").val(),
                    modelPathname:  $("#user-scenario-folder-pathname").val() + "\\" + modelName,
                    removeFolderOnCompletion: false
                }
            })
            .then(function(response) {
                $("#scenario-id").val(response.data.scenarioID);
            });
            break;

        case 'ExtendSim/checkmodelrunstatus':
        
            axios({
                url: proxyurl + queryURL_root + this.id,
                method: 'post',
                accept : 'application/json',
                contentType: 'application/json;charset=utf-8',
                data: {
                    scenarioID: $("#scenario-id").val(),
                }
            })
            .then(function(response) {
                $("#scenario-status").val(scenarioStatusValues[response.data.modelRunStatus - 1]);
            });
           break;
      }
    });

    $('.login').keyup(function () {
        if (($("#username").val() === '') || ($("#password").val() === '')) {
            //Check to see if there is any text entered
            // If there is no text within the input ten disable the button
            $('.buttons').prop('disabled', true);
        } else {
            //If there is text in the input, then enable the button
            $('.buttons').prop('disabled', false);
        }
    });
    $('#scenario-name').keyup(function () {
        if ($("#scenario-name").val() !== '') {
            if ($('#user-models').val() !== '') {
                $('.scenario-input-file-buttons').prop('disabled', false);
                $('.scenario-database-input-buttons').prop('disabled', false);
                $('.scenario-dialog-input-buttons').prop('disabled', false);
            }
        }
    });
</script>
</body>

</html>
